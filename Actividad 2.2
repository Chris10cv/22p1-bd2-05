/*
1.- PROCEDIMIENTO 
*/
drop procedure IF EXISTS bd_sample.sp_guardar_subscritor;

DELIMITER //
create procedure bd_sample.sp_guardar_subscritor (
	in p_id_subscritor     			int,
    	in p_codigo_subscritor 			int,
    	in p_nombres				varchar (25),
    	in p_apellidos 				varchar (25)
)
BEGIN 
	declare  v_id_subscriptor 		int;
	declare  v_codigo_subscriptor 		int;
	declare  v_nombres 			varchar (25);
	declare  v_apellidos 			varchar (25);
    
    	set v_id_subscriptor			= p_id_subscritor;
    	set v_codigo_subscriptor		= p_codigo_subscritor;
    	set v_nombres				= p_nombres;
    	set v_apellidos				= p_apellidos;

	insert into bd_sample.tbl_subscriptores (
	id_subscriptor, codigo_subscriptor, nombres, apellidos
	) values (
	v_id_subscriptor, v_codigo_subscriptor, v_nombres, v_apellidos 
	);

	commit;
END;

--------------------------------------------------------------------------------


/*
Procedimiento 2
*/

drop procedure IF EXISTS bd_sample.sp_guardar_producto;

select * from bd_sample.tbl_productos;

DELIMITER $$ 
create procedure bd_sample.sp_guardar_producto (
    in p_id_producto     	int,
    in p_nombre 		varchar (25),
    in p_descripcion 		varchar (25),
    in p_precio_costo 		decimal (12,2),
    in p_precio_venta 		decimal (12,2)
    
)
BEGIN 

	declare  v_id_producto 		int;
	declare  v_nombre		varchar (25);
	declare  v_descripcion 		varchar (25);
	declare  v_precio_costo 	decimal (12,2);
   	declare  v_precio_venta 	decimal (12,2);
    
    set v_id_producto       	= p_id_producto;
    set v_nombre		= P_nombre;
    set  v_descripcion		= p_descripcion;
    set  v_precio_costo		= p_precio_costo;    
    set v_precio_venta 		= p_precio_venta * 1.25;
    
	insert into bd_sample.tbl_productos (
	id_producto, nombre, descripcion, precio_costo, precio_venta
	) values (
	v_id_producto, v_nombre, v_descripcion, v_precio_costo, v_precio_venta
	);

	commit;
END;


select * from bd_sample.tbl_productos

CALL bd_sample.sp_guardar_producto (
0,		 		# p_id_producto
'Plan Diamond',			# p_nombre 
'Plan VIP', 			# p_descripcion 	
20,				# p_precio_costo
20 				# p_precio_venta
);



--------------------------------------------------------------------------------
/*
3.- PROCEDIMIENTO 
*/
drop procedure IF EXISTS bd_sample.sp_guardar_factura;

DELIMITER //
create procedure bd_sample.sp_guardar_factura (
    in p_id_factura 			int,
    in p_fecha_emision			datetime,
    in p_id_subscriptor			int,
    in p_numero_items			int,
    in p_isv_total			decimal(12,2),
    in p_subtotal			decimal(12,2)
)

BEGIN

    declare v_id_factura 		int;
    declare v_fecha_emision		datetime;
    declare v_id_subscriptor		int;
    declare v_numero_items		int;
    declare v_isv_total			decimal(12,2);
    declare v_subtotal			decimal(12,2);
    declare v_totapagar			decimal(12,2);

    set v_id_factura 		=  	p_id_factura; 
    set v_fecha_emision		=	p_fecha_emision;
    set v_id_subscriptor	=	p_id_subscriptor;
    set v_numero_items		=	p_numero_items;
    set v_isv_total		=	p_isv_total;
    set v_subtotal		=	p_subtotal;
    set v_totapagar		=	p_totapagar;
    
	insert into bd_sample.tbl_facturas ( 
    id_factura, fecha_emision, id_subscriptor, numero_items,
    isv_total, subtotal, totapagar
    )values( 
    v_id_factura, v_fecha_emision, v_id_subscriptor, v_numero_items,
    v_isv_total, v_subtotal, v_totapagar
    );

COMMIT;
END;

--------------------------------------------------------------------------------
